
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <title>Section 14.3: Concurrency in PHP Â· Small-Scale Real-Time Modern Web Applications</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 4.0.8">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../chapter_15_webography/" />
    
    
    <link rel="prev" href="2_asynchronous_runtimes.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Cover
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 1: Introduction</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../part_1_introduction/0_abstract/">
            
                <a href="../../part_1_introduction/0_abstract/">
            
                    
                    Abstract
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../part_1_introduction/1_general_introduction/">
            
                <a href="../../part_1_introduction/1_general_introduction/">
            
                    
                    General Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../part_1_introduction/chapter_1_general_context/">
            
                <a href="../../part_1_introduction/chapter_1_general_context/">
            
                    
                    Chapter 1: General Context
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 2: Analysis And Conception</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../part_2_analysis_and_conception/chapter_2_project_structure/">
            
                <a href="../../part_2_analysis_and_conception/chapter_2_project_structure/">
            
                    
                    Chapter 2: Project Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../../part_2_analysis_and_conception/chapter_3_tools/">
            
                <a href="../../part_2_analysis_and_conception/chapter_3_tools/">
            
                    
                    Chapter 3: Tools
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 3: Technical Design And Implementation</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../part_3_technical_design_and_implementation/chapter_4_client_server_architecture/">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_4_client_server_architecture/">
            
                    
                    Chapter 4: Client Server Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../../part_3_technical_design_and_implementation/chapter_4_client_server_architecture/1_request_response_cycle.html">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_4_client_server_architecture/1_request_response_cycle.html">
            
                    
                    Section 4.1: Request Response Cycle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../../part_3_technical_design_and_implementation/chapter_4_client_server_architecture/2_web_server.html">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_4_client_server_architecture/2_web_server.html">
            
                    
                    Section 4.2: Web Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="../../part_3_technical_design_and_implementation/chapter_4_client_server_architecture/3_application_server.html">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_4_client_server_architecture/3_application_server.html">
            
                    
                    Section 4.3: Application Server
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../../part_3_technical_design_and_implementation/chapter_5_server_side_non_blocking/">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_5_server_side_non_blocking/">
            
                    
                    Chapter 5: Server Side Non-Blocking
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../../part_3_technical_design_and_implementation/chapter_5_server_side_non_blocking/1_background_jobs.html">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_5_server_side_non_blocking/1_background_jobs.html">
            
                    
                    Section 5.1: Background Jobs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="../../part_3_technical_design_and_implementation/chapter_5_server_side_non_blocking/2_events.html">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_5_server_side_non_blocking/2_events.html">
            
                    
                    Section 5.2: Events
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../../part_3_technical_design_and_implementation/chapter_6_real_time_protocols_and_techniques/">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_6_real_time_protocols_and_techniques/">
            
                    
                    Chapter 6: Real-Time Protocols And Techniques
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1" data-path="../../part_3_technical_design_and_implementation/chapter_6_real_time_protocols_and_techniques/1_websocket_server.html">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_6_real_time_protocols_and_techniques/1_websocket_server.html">
            
                    
                    Section 6.1: Websocket Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2" data-path="../../part_3_technical_design_and_implementation/chapter_6_real_time_protocols_and_techniques/2_websocket_client.html">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_6_real_time_protocols_and_techniques/2_websocket_client.html">
            
                    
                    Section 6.2: Websocket Client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3" data-path="../../part_3_technical_design_and_implementation/chapter_6_real_time_protocols_and_techniques/3_real_time_communication_techniques.html">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_6_real_time_protocols_and_techniques/3_real_time_communication_techniques.html">
            
                    
                    Section 6.3: Real-Time Communication Techniques
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.4" data-path="../../part_3_technical_design_and_implementation/chapter_6_real_time_protocols_and_techniques/4_ajax.html">
            
                <a href="../../part_3_technical_design_and_implementation/chapter_6_real_time_protocols_and_techniques/4_ajax.html">
            
                    
                    Section 6.4: Ajax
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part 4: Building a Real-Time Web App</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../../part_4_building_a_real_time_web_app/chapter_7_overview_on_how_to_build_a_web_app/">
            
                <a href="../../part_4_building_a_real_time_web_app/chapter_7_overview_on_how_to_build_a_web_app/">
            
                    
                    Chapter 7: Overview on how to Build a Web App
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../../part_4_building_a_real_time_web_app/chapter_8_laravel_as_a_backend_framework/">
            
                <a href="../../part_4_building_a_real_time_web_app/chapter_8_laravel_as_a_backend_framework/">
            
                    
                    Chapter 8: Laravel as a Backend Framework
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../../part_4_building_a_real_time_web_app/chapter_8_laravel_as_a_backend_framework/1_the_scaffolding_of_a_laravel_app.html">
            
                <a href="../../part_4_building_a_real_time_web_app/chapter_8_laravel_as_a_backend_framework/1_the_scaffolding_of_a_laravel_app.html">
            
                    
                    Section 8.1: The Scaffolding of a Laravel App
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="../../part_4_building_a_real_time_web_app/chapter_8_laravel_as_a_backend_framework/2_service_providers.html">
            
                <a href="../../part_4_building_a_real_time_web_app/chapter_8_laravel_as_a_backend_framework/2_service_providers.html">
            
                    
                    Section 8.2: Service Providers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.3" data-path="../../part_4_building_a_real_time_web_app/chapter_8_laravel_as_a_backend_framework/3_facades.html">
            
                <a href="../../part_4_building_a_real_time_web_app/chapter_8_laravel_as_a_backend_framework/3_facades.html">
            
                    
                    Section 8.3: Facades
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.4" data-path="../../part_4_building_a_real_time_web_app/chapter_8_laravel_as_a_backend_framework/4_the_rest.html">
            
                <a href="../../part_4_building_a_real_time_web_app/chapter_8_laravel_as_a_backend_framework/4_the_rest.html">
            
                    
                    Section 8.4: The Rest
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../../part_4_building_a_real_time_web_app/chapter_9_vue_js_3_as_a_frontend_framework/">
            
                <a href="../../part_4_building_a_real_time_web_app/chapter_9_vue_js_3_as_a_frontend_framework/">
            
                    
                    Chapter 9: Vue.js 3 as a Frontend Framework
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.3.1" data-path="../../part_4_building_a_real_time_web_app/chapter_9_vue_js_3_as_a_frontend_framework/1_state_management_in_vuejs_3.html">
            
                <a href="../../part_4_building_a_real_time_web_app/chapter_9_vue_js_3_as_a_frontend_framework/1_state_management_in_vuejs_3.html">
            
                    
                    Section 9.1: State Management in Vue.js 3
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="../../part_4_building_a_real_time_web_app/chapter_10_monolithic_architecture/">
            
                <a href="../../part_4_building_a_real_time_web_app/chapter_10_monolithic_architecture/">
            
                    
                    Chapter 10: Monolothic Architecture
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 5: Conclusion</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../../part_5_conclusion/chapter_11_takeaways/">
            
                <a href="../../part_5_conclusion/chapter_11_takeaways/">
            
                    
                    Chapter 11: Takeaways
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../../part_5_conclusion/chapter_12_general_conclusion/">
            
                <a href="../../part_5_conclusion/chapter_12_general_conclusion/">
            
                    
                    Chapter 12: General Conclusion
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 6: Appendix</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../chapter_13_essential_concepts/">
            
                <a href="../chapter_13_essential_concepts/">
            
                    
                    Chapter 13: Essential Concepts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" data-path="../chapter_13_essential_concepts/1_closures.html">
            
                <a href="../chapter_13_essential_concepts/1_closures.html">
            
                    
                    Section 13.1: Closures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2" data-path="../chapter_13_essential_concepts/2_coroutines.html">
            
                <a href="../chapter_13_essential_concepts/2_coroutines.html">
            
                    
                    Section 13.2: Coroutines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.3" data-path="../chapter_13_essential_concepts/3_generators.html">
            
                <a href="../chapter_13_essential_concepts/3_generators.html">
            
                    
                    Section 13.3: Generators
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="./">
            
                <a href="./">
            
                    
                    Chapter 14: Concurrency
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.2.1" data-path="1_concurrency_overview.html">
            
                <a href="1_concurrency_overview.html">
            
                    
                    Section 14.1: Concurrency Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.2" data-path="2_asynchronous_runtimes.html">
            
                <a href="2_asynchronous_runtimes.html">
            
                    
                    Section 14.2: Asynchronous Runtimes
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="7.2.3" data-path="3_concurrency_in_php.html">
            
                <a href="3_concurrency_in_php.html">
            
                    
                    Section 14.3: Concurrency in PHP
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="../chapter_15_webography/">
            
                <a href="../chapter_15_webography/">
            
                    
                    Chapter 15: Webography
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Section 14.3: Concurrency in PHP</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="33-concurrency-in-php">3.3 Concurrency in PHP</h2>
<h3 id="how-to-implement-concurrency-in-php">How to implement concurrency in PHP?</h3>
<p>Concurrency in PHP can be achieved in several ways:</p>
<ul>
<li><strong>Child Processes</strong>: PHP supports the creation of child processes using the <code>pcntl_fork()</code> function. This function creates a new process by duplicating the current process. The child process can then run concurrently with the parent process.</li>
</ul>
<pre><code class="lang-php">

    <span class="hljs-variable">$pid</span> = pcntl_fork();

    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pid</span> == -<span class="hljs-number">1</span>) {
         <span class="hljs-keyword">die</span>(<span class="hljs-string">&apos;could not fork&apos;</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pid</span>) {
         <span class="hljs-comment">// we are the parent</span>
         pcntl_wait(<span class="hljs-variable">$status</span>); <span class="hljs-comment">//Protect against Zombie children</span>
         <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Parent: The child process has exited.\n&quot;</span>;
    } <span class="hljs-keyword">else</span> {
         <span class="hljs-comment">// we are the child</span>
         <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Child: I am the child process.\n&quot;</span>;
    }
</code></pre>
<ul>
<li><strong>Multi-Threading</strong>: PHP does not natively support multi-threading. However, the PHP extension pthreads provides a convenient and robust way of creating multi-threaded applications in PHP. It allows you to create, read, write, execute, and synchronize threads. The <code>parallel</code> extension in PHP provides a simple API for parallel computing, which is the simultaneous execution of multiple calculations or processes. It allows running a PHP code block asynchronously in a separate thread and then fetching the result when available.</li>
</ul>
<p>The following is a multi-threading in PHP example using the <strong>pthreads</strong> extension</p>
<pre><code class="lang-php">


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WorkerThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Thread</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$workerId</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;workerId = <span class="hljs-variable">$id</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Worker <span class="hljs-subst">$this</span>-&gt;workerId running\n&quot;</span>;
        <span class="hljs-comment">// Simulate some work being done</span>
        sleep(<span class="hljs-number">2</span>);
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Worker <span class="hljs-subst">$this</span>-&gt;workerId completed\n&quot;</span>;
    }
}

<span class="hljs-comment">// Create two worker threads</span>
<span class="hljs-variable">$worker1</span> = <span class="hljs-keyword">new</span> WorkerThread(<span class="hljs-number">1</span>);
<span class="hljs-variable">$worker2</span> = <span class="hljs-keyword">new</span> WorkerThread(<span class="hljs-number">2</span>);

<span class="hljs-comment">// Start the threads</span>
<span class="hljs-variable">$worker1</span>-&gt;start();
<span class="hljs-variable">$worker2</span>-&gt;start();

<span class="hljs-comment">// Join the threads</span>
<span class="hljs-variable">$worker1</span>-&gt;join();
<span class="hljs-variable">$worker2</span>-&gt;join();
</code></pre>
<p></p><div class="alert alert-danger hints-alert"><div class="hints-icon"><i class="fa fa-exclamation-circle"></i></div><div class="hints-container"><p>As of PHP 7.4, the <strong>pthreads</strong> extension is no longer maintained and has been superseded by the <strong>parallel</strong> extension for multi-threading in PHP</p>
</div></div><p></p>
<p>The following is a multi-threading in PHP example using the <strong>parallel</strong> extension</p>
<pre><code class="lang-PHP"><span class="hljs-comment">// Check if the parallel extension is loaded</span>
<span class="hljs-keyword">if</span> (!extension_loaded(<span class="hljs-string">&apos;parallel&apos;</span>)) {
    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&apos;The parallel extension is not installed&apos;</span>);
}

<span class="hljs-comment">// Define a simple function that will be run in parallel</span>
<span class="hljs-variable">$run</span> = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello from thread!\n&quot;</span>;
};

<span class="hljs-comment">// Create two runtime instances</span>
<span class="hljs-variable">$runtime1</span> = <span class="hljs-keyword">new</span> \parallel\Runtime();
<span class="hljs-variable">$runtime2</span> = <span class="hljs-keyword">new</span> \parallel\Runtime();

<span class="hljs-comment">// Create two futures</span>
<span class="hljs-variable">$future1</span> = <span class="hljs-variable">$runtime1</span>-&gt;run(<span class="hljs-variable">$run</span>);
<span class="hljs-variable">$future2</span> = <span class="hljs-variable">$runtime2</span>-&gt;run(<span class="hljs-variable">$run</span>);

<span class="hljs-comment">// Ensure both futures have completed before continuing</span>
<span class="hljs-variable">$future1</span>-&gt;value();
<span class="hljs-variable">$future2</span>-&gt;value();

<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;All threads have completed.\n&quot;</span>;
</code></pre>
<p><a href="https://mermaid.live/edit#pako:eNptkUFrwzAMhf-K8Dk9JEcfetl2LIy1MBi-CFtZzGI5c2TGKP3vc9omLFtOlp-_Jxm9s7LRkdJqpM9MbOnR43vCYPgZk3jrB2SBA3oGHG_nqUuEbg28ZBYfqJ6g15g-KN0xqDfB5j_YGJ7a7_b7uZmGoxTrX71Z9BlceUoFbWYrPvKCNCv7JlLvCjNN0vAQw9CT0C_7xtv9V7NcQM4EX146SDQKxBZGm_wgqlKBUkDvyp7PhgGMko4CGaVL6ajF3ItRhi8FxSzx-M1WaUmZKpUHhzLHonSL_bioT85LTItI1-vhFug110qVrb_FOBsvP2cGr9g" target="_blank"><img src="https://mermaid.ink/img/pako:eNptkUFrwzAMhf-K8Dk9JEcfetl2LIy1MBi-CFtZzGI5c2TGKP3vc9omLFtOlp-_Jxm9s7LRkdJqpM9MbOnR43vCYPgZk3jrB2SBA3oGHG_nqUuEbg28ZBYfqJ6g15g-KN0xqDfB5j_YGJ7a7_b7uZmGoxTrX71Z9BlceUoFbWYrPvKCNCv7JlLvCjNN0vAQw9CT0C_7xtv9V7NcQM4EX146SDQKxBZGm_wgqlKBUkDvyp7PhgGMko4CGaVL6ajF3ItRhi8FxSzx-M1WaUmZKpUHhzLHonSL_bioT85LTItI1-vhFug110qVrb_FOBsvP2cGr9g?type=png" alt></a></p>
<ul>
<li><strong>Generators and Coroutines</strong>: PHP 5.5 introduced generators, which allow you to write code that uses <code>yield</code> to generate a sequence of values. This can be used to implement simple coroutines, which can be used to manage concurrency.</li>
</ul>
<p></p><div class="alert alert-info hints-alert"><div class="hints-icon"><i class="fa fa-info-circle"></i></div><div class="hints-container"><p><strong>definition:</strong> a coroutine is a function which its execution can be paused and resumed</p>
<p><strong>coroutines</strong> can be synchronous/single threaded or asynchronous/multi-threaded</p>
</div></div><p></p>
<p>The following example illustrates single threaded coroutines using the native php generators</p>
<pre><code class="lang-PHP"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">integers</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">yield</span> <span class="hljs-variable">$i</span>++;
    }
}

<span class="hljs-variable">$generator</span> = integers();

<span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">5</span>; <span class="hljs-variable">$i</span>++) {
    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$generator</span>-&gt;current(), <span class="hljs-string">&quot;\n&quot;</span>;
    <span class="hljs-variable">$generator</span>-&gt;next();
}
</code></pre>
<p>The following example illustrates concurrent coroutines using the swoole php extension</p>
<pre><code class="lang-PHP">Swoole\Coroutine::create(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-variable">$cid</span> = Swoole\Coroutine::getCid();
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Start coroutine <span class="hljs-subst">$cid</span>\n&quot;</span>;

    Swoole\Coroutine::sleep(<span class="hljs-number">1</span>);

    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;End coroutine <span class="hljs-subst">$cid</span>\n&quot;</span>;
});

Swoole\Coroutine::create(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-variable">$cid</span> = Swoole\Coroutine::getCid();
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Start coroutine <span class="hljs-subst">$cid</span>\n&quot;</span>;

    Swoole\Coroutine::sleep(<span class="hljs-number">1</span>);

    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;End coroutine <span class="hljs-subst">$cid</span>\n&quot;</span>;
});

<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;End of script\n&quot;</span>;
</code></pre>
<ul>
<li><strong>Asynchronous Programming</strong>: Asynchronous programming allows you to perform long-running tasks, such as I/O operations, without blocking the execution of the rest of your code. Libraries like ReactPHP, Amp, and Swoole provide tools for writing asynchronous code in PHP. Promises and futures are constructs used in concurrent programming to represent the result of a computation that may not have completed yet. Libraries like Guzzle&apos;s promises or ReactPHP&apos;s promises can be used to manage concurrency in PHP.</li>
</ul>
<p>example of asynchronous operations using <strong>reactPHP</strong> extension</p>
<pre><code class="lang-PHP"><span class="hljs-keyword">require</span> <span class="hljs-string">&apos;vendor/autoload.php&apos;</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">React</span>\<span class="hljs-title">EventLoop</span>\<span class="hljs-title">Factory</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">React</span>\<span class="hljs-title">Promise</span>\<span class="hljs-title">Timer</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">React</span>\<span class="hljs-title">Promise</span>\<span class="hljs-title">Coroutine</span>;

<span class="hljs-variable">$loop</span> = Factory::create();

<span class="hljs-variable">$asyncFunction</span> = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable">$time</span></span>) <span class="hljs-keyword">use</span> (<span class="hljs-params"><span class="hljs-variable">$loop</span></span>) </span>{
    <span class="hljs-keyword">return</span> Timer\resolve(<span class="hljs-variable">$time</span>, <span class="hljs-variable">$loop</span>)-&gt;then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello, world!\n&quot;</span>;
    });
};

<span class="hljs-variable">$coroutine</span> = Coroutine\create(<span class="hljs-variable">$asyncFunction</span>(<span class="hljs-number">1.0</span>));

<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;This will be output immediately.\n&quot;</span>;

<span class="hljs-variable">$loop</span>-&gt;run();
</code></pre>
<p>The following is the same example but using the <strong>amphp</strong> extension</p>
<pre><code class="lang-PHP"><span class="hljs-keyword">require</span> <span class="hljs-string">&apos;vendor/autoload.php&apos;</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">Loop</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">function</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">asyncCall</span>;

Loop::run(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    asyncCall(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-comment">// Simulate an async I/O operation with a delay</span>
        <span class="hljs-keyword">yield</span> Amp\delay(<span class="hljs-number">1000</span>);
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello, world!\n&quot;</span>;
    });

    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;This will be output immediately.\n&quot;</span>;
});
</code></pre>
<p></p><div class="alert alert-success hints-alert"><div class="hints-icon"><i class="fa fa-mortar-board"></i></div><div class="hints-container"><p>with you use of coroutines are just functions that can pause/resume their execution.</p>
<p>So technically you can achieve <strong>concurrency in a single thread</strong> using coroutines</p>
<p>Amphp uses this approach as it utilizes a single thread and non-blocking async calls using coroutines</p>
</div></div><p></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="2_asynchronous_runtimes.html" class="navigation navigation-prev " aria-label="Previous page: Section 14.2: Asynchronous Runtimes">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../chapter_15_webography/" class="navigation navigation-next " aria-label="Next page: Chapter 15: Webography">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Section 14.3: Concurrency in PHP","level":"7.2.3","depth":2,"next":{"title":"Chapter 15: Webography","level":"7.3","depth":1,"path":"part_6_appendix/chapter_15_webography/README.md","ref":"part_6_appendix/chapter_15_webography/README.md","articles":[]},"previous":{"title":"Section 14.2: Asynchronous Runtimes","level":"7.2.2","depth":2,"path":"part_6_appendix/chapter_14_concurrency/2_asynchronous_runtimes.md","ref":"part_6_appendix/chapter_14_concurrency/2_asynchronous_runtimes.md","articles":[]},"dir":"ltr"},"config":{"plugins":["chapter-fold","hide-published-with","hints","theme-creative"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"chapter-fold":{},"asciidoc":{"numbered":{},"chapter-fold":{},"hints":{"info":"fa fa-info-circle","tip":"fa fa-mortar-board","danger":"fa fa-exclamation-cicle","working":"fa fa-wrench"}},"search":{},"hints":{"info":"fa fa-info-circle","tip":"fa fa-mortar-board","danger":"fa fa-exclamation-circle","working":"fa fa-wrench"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"hide-published-with":{},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-creative":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"highlight":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"hidepagefooters":[],"copyright":"Dhia Eddine Nabli","authors":["Dhia Eddine Nabli"],"theme":"default","keywords":["PHP","JS"],"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":32,"left":32,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"hidepageheaders":[],"variables":{},"title":"Small-Scale Real-Time Modern Web Applications","language":"en","gitbook":"*","description":"Small-Scale Real-Time Modern Web Applications"},"file":{"path":"part_6_appendix/chapter_14_concurrency/3_concurrency_in_php.md","mtime":"2023-09-05T10:24:31.245Z","type":"markdown"},"gitbook":{"version":"4.0.8","time":"2023-09-05T10:24:45.392Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-hide-published-with/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

